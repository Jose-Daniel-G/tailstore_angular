import{a as p}from"./chunk-NNP535OP.js";import{O as u,T as m,f as l,j as n,m as c,n as i}from"./chunk-PSGGF63T.js";var g=class s{constructor(e){this.http=e;this.initializeDefaultUser()}currentUserLoginOn=new n(!1);currentUserData=new n({id:0,email:""});initializeDefaultUser(){if(JSON.parse(localStorage.getItem("users")||"[]").length===0){let t={id:1,name:"Jose",lastName:"Grijalba",email:"jose@gmail.com",password:"12345678",message:"Autenticaci\xF3n ok"};localStorage.setItem("users",JSON.stringify([t]))}}login(e){let r=JSON.parse(localStorage.getItem("users")||"[]").find(o=>o.email===e.email&&o.password===e.password);return r?(this.currentUserData.next(r),this.currentUserLoginOn.next(!0),console.log("Usuario logueado:",r),c(r)):i(()=>new Error("Usuario o contrase\xF1a incorrectos"))}register(e){return new l(t=>{try{let r=JSON.parse(localStorage.getItem("users")||"[]"),a={id:r.length>0?Math.max(...r.map(f=>f.id))+1:1,email:e.email,name:e.name||"",lastName:e.lastName||"",password:e.password,message:"Autenticaci\xF3n ok"};r.push(a),localStorage.setItem("users",JSON.stringify(r)),this.currentUserData.next(a),this.currentUserLoginOn.next(!0),t.next(a),t.complete()}catch(r){t.error(r)}})}handleError(e){return console.error("Error capturado en handleError:",e),e.status===0?console.log("Se ha producido un error: ",e.error):console.log("El backend retorno el codigo de estado: ",e.status,e.error),i(()=>new Error("Algo fallo. por favor intente nuevamente"))}get userData(){return this.currentUserData.asObservable()}get userLoginOn(){return this.currentUserLoginOn.asObservable()}static \u0275fac=function(t){return new(t||s)(m(p))};static \u0275prov=u({token:s,factory:s.\u0275fac,providedIn:"root"})};export{g as a};
